<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Manage Product Tree</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <main class="container">
    <header class="page-header">
      <h1 class="gapi-heading gapi-title-violet">MANAGE PRODUCT TREE</h1>
      <p class="subtitle">Import Product Tree XML and manage your product hierarchy with AI assistance.</p>
    </header>

    <section class="panel">
      <h2>1) IMPORT PRODUCT TREE</h2>
      <div class="grid2">
        <div>
          <h3>XML IMPORT</h3>
          <div id="dropZone" class="drop">Drop Product Tree XML here</div>
          <div class="row"><input id="xmlFile" type="file" accept=".xml,text/xml" /></div>
          <p class="hint">Import XML files generated by the Product Tree from Jira tool.</p>
        </div>
        <div>
          <h3>AI ASSISTANCE</h3>
          <div class="row">
            <label>AI Model</label>
            <select id="aiModel">
              <option value="internal">Internal AI Model</option>
            </select>
          </div>
          <div class="row">
            <label>API Endpoint</label>
            <input id="apiEndpoint" placeholder="http://localhost:8081" value="http://localhost:8081" />
          </div>
          <button id="btnTestConnection" class="btn-accent">Test Connection</button>
          <p class="hint">Connect to the standalone Dot service for AI assistance.</p>
        </div>
      </div>
      <div id="importSummary" class="summary"></div>
    </section>

    <section class="panel" id="treePanel" style="display: none;">
      <h2>2) PRODUCT TREE</h2>
      <div class="toolbar">
        <div class="search-box">
          <input id="searchInput" placeholder="Search nodes..." />
        </div>
        <div class="toolbar-buttons">
          <button id="btnExpandAll" class="btn-outline">Expand All</button>
          <button id="btnCollapseAll" class="btn-outline">Collapse All</button>
          <button id="btnExportXML" class="btn-outline">Export XML</button>
          <button id="btnExportJira" class="btn-outline">Export Jira CSV</button>
          <button id="btnDebug" class="btn-outline">Debug Tree</button>
        </div>
      </div>
      
      <div class="tree-layout">
        <div id="productTree" class="tree-container">
          <!-- Tree will be rendered here -->
        </div>
        <div class="node-details-panel">
          <h3>Node Details</h3>
          <div id="nodeDetails" class="node-details-container">
            <p>Select a node to view details</p>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="aiPanel" style="display: none;">
      <h2>3) AI ASSISTANCE</h2>
      <div class="ai-chat">
        <div id="aiMessages" class="ai-messages"></div>
        <div class="ai-input">
          <input id="aiInput" placeholder="Ask AI about your product tree..." />
          <button id="btnSendAI" class="btn-accent">Send</button>
        </div>
      </div>
    </section>

    <footer class="site-footer">
      <small>Standalone Product Tree Manager. MIT-licensed.</small>
    </footer>
  </main>

  <!-- Work Item Modal -->
  <div id="workItemModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Work Item Details</h3>
        <button id="closeModal" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div id="workItemContent">
          <!-- Work item content will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
